<!-- Pagina operativa: mostra il turno corrente, la settimana e le azioni sulla coda. -->
<div class="page-center">
  <mat-card appearance="outlined" class="panel">
    <mat-card-header>
      <mat-card-title class="text-title">Turno Corrente</mat-card-title>
      <mat-card-subtitle class="text-subtitle">Oggi Ã¨ {{ currentDayLabel }} - Tocca a {{ currentName || 'Nessuno' }}</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content class="content">
      <mat-chip-set *ngIf="vacationNames.length" aria-label="Utenti in vacanza">
        <mat-chip disabled *ngFor="let name of vacationNames">{{ name }}</mat-chip>
      </mat-chip-set>

      <div class="actions-row">
        <button mat-flat-button class="text-label text-on-accent btn-tonal-alt" type="button" (click)="markSkip()" [disabled]="actionLoading">
          Salta
        </button>
        <button
          mat-flat-button
          class="text-label text-on-accent btn-tonal-cta"
          type="button"
          (click)="markDone()"
          [disabled]="actionLoading || !isMyTurn || isOnVacation"
        >
          Lavato
        </button>
      </div>

      <button mat-flat-button class="text-label text-on-accent btn-tonal" type="button" (click)="toggleVacation()" [disabled]="actionLoading">
        {{ isOnVacation ? 'Torno disponibile' : 'Vado in vacanza' }}
      </button>

      <mat-progress-bar *ngIf="actionLoading || loading" mode="indeterminate"></mat-progress-bar>
      <p *ngIf="actionLoading" class="hint-text text-caption">Aggiornamento in corso: {{ actionLabel }}...</p>

      <h3 class="text-body-strong">Restante settimana</h3>
      <mat-list>
        <mat-list-item *ngFor="let item of weekList">
          <span matListItemTitle class="text-body-strong">{{ item.name }}</span>
          <span matListItemLine class="text-caption">{{ item.dayLabel }}</span>
        </mat-list-item>
      </mat-list>

      <div class="actions-row">
        <a mat-flat-button class="text-label text-on-accent btn-tonal" routerLink="/history">History</a>
        <a mat-flat-button class="text-label text-on-accent btn-tonal" routerLink="/stats">Stats</a>
      </div>

      <p *ngIf="message" class="error-text text-feedback-error">{{ message }}</p>
    </mat-card-content>
  </mat-card>
</div>
